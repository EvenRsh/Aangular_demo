<!DOCTYPE html>
<html lang="en" ng-app="ionicApp">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title>ionic</title>
    <link rel="stylesheet" type="text/css" href="./assets/ionic-v1.0.1/css/ionic.css">
    <script type="text/javascript" src="assets/ionic-v1.0.1/js/ionic.bundle.js"></script>
</head>

<body>
    <div ng-controller="indexCtrl">
        <!-- <div class="bar bar-header bar-royal">
    <h1 class="title">{{title}}</h1>
</div>
 -->
        <ion-header-bar align-title="center">
            <h1 class="title">{{title}}</h1>
        </ion-header-bar>
        <!-- <div class="content has-header padding">
            <p>
                <button class="button button-light">button-light</button>
            </p>
            <p>
                <button class="button button-stable">button-stable</button>
            </p>
            <p>
                <button class="button button-positive">button-positive</button>
            </p>
            <p>
                <button class="button button-calm">button-calm</button>
            </p>
            <p>
                <button class="button button-balanced">button-balanced</button>
            </p>
            <p>
                <button class="button button-energized">button-energized</button>
            </p>
            <p>
                <button class="button button-assertive">button-assertive</button>
            </p>
            <p>
                <button class="button button-royal">button-royal</button>
            </p>
            <p>
                <button class="button button-dark">button-dark</button>
            </p>
        </div> -->
        <ion-content>
            <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()">
            </ion-refresher>
            <div class="list card" ng-repeat="arr in arrs">
                <div class="item item-avatar">
                    <img ng-src="{{arr.image}}">
                    <h2>{{arr.title}}</h2>
                    <p>November 05, 1955</p>
                </div>
                <div class="item item-body">
                    <img class="full-image" ng-src="{{arr.image}}">
                    <p>
                        {{arr.text}}
                    </p>
                    <p>
                        <a href="#" class="subdued">1 喜欢</a>
                        <a href="#" class="subdued">5 评论</a>
                    </p>
                </div>
                <div class="item tabs tabs-secondary tabs-icon-left">
                    <a class="tab-item" href="#">
                        <i class="icon ion-thumbsup"></i> 喜欢
                    </a>
                    <a class="tab-item" href="#">
                        <i class="icon ion-chatbox"></i> Comment
                    </a>
                    <a class="tab-item" href="#">
                        <i class="icon ion-share"></i> 分享
                    </a>
                </div>
            </div>
            <ion-infinite-scroll icon="ion-checkmark" on-infinite="loadMore()" distance="1%">
            </ion-infinite-scroll>
        </ion-content>
        <!--  <div class="bar bar-footer bar-dark">
            <button class="button button-clear">Left</button>
            <div class="title">Title</div>
            <button class="button button-clear">Right</button>
        </div> -->
    </div>
</body>
<script type="text/javascript">
var app = angular.module('ionicApp', ['ionic', 'controllers', 'directives', 'services']);
var controllers = angular.module('controllers', []);
controllers.controller('indexCtrl', ['$scope', '$http', function($scope, $http) {
    $scope.name = "ionic";
    $scope.title = "标题";
    $scope.arrs = [];
    $scope.doRefresh = () => {
        $http.get('http://10.16.155.28:81/news/php/index.php/news_api/show_detail_by_channel_id', {
            params: {
                channel_id: 4
            }
        }).success(function(data) {
            console.log(data);
            $scope.arrs = data.news_list.concat($scope.arrs);
            // 停止广播ion-refresher
            $scope.$broadcast('scroll.refreshComplete');
        })
    }
    $scope.loadMore=()=>{
    	 $http.get('http://10.16.155.28:81/news/php/index.php/news_api/show_detail_by_channel_id', {
            params: {
                channel_id: 4
            }
        }).success(function(data) {
            console.log(data);
            $scope.arrs = $scope.arrs.concat(data.news_list);
            // 停止广播ion-refresher
             $scope.$broadcast('scroll.infiniteScrollComplete')
        })
    }
}])
var directives = angular.module('directives', []);
var services = angular.module('services', []);
</script>

</html>
