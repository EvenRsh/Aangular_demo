<!DOCTYPE html>
<html lang="en" ng-app="indexApp">

<head>
    <meta charset="UTF-8">
    <title>angular初步学习</title>
    <style type="text/css">
    * {
        margin: 0;
        padding: 0;
    }
    
    ul {
        display: flex;
        flex-direction: column;
        list-style: none;
        width: 300px;
        height: 30px;
        /*border: 1px solid #ccc;*/
        margin: 20px auto 0;
    }
    
    li {
        /*flex:1;*/
        padding: 0 10px;
        text-align: center;
        line-height: 30px;
        border: 1px solid #ccc;
    }
    
    li:not(:last-child) {
        /*border-right: 1px solid #f00;*/
    }
    
    .content,
    .content>div {
        position: relative;
        width: 300px;
        height: 300px;
        line-height: 300px;
        border: 1px solid #ccc;
        margin: 0 auto;
    }
    
    .content>div {
        /*position: absolute;*/
        /*display: none;*/
        text-align: center;
        font-size: 40px;
        color: #f00;
        background-color: #fff;
    }
    
    .content .selected {
        display: block;
        background-color: #e50de2;
    }
    
    .btn {
        background-color: blue;
    }
    </style>
    <script src="js/angular.js"></script>
    <script src="assets/jQuery/jquery-3.1.1.js"></script>
</head>

<body>
    <div ng-controller="indexCtrl">
       <input type="text" ng-model="search" name="" ng-keyup="makered()">
       <div>
           <p ng-bind-html="htmlSce"></p>
       </div>

       <p>{{num}}</p>

       <input type="text" ng-model="ask" ng-blur="submit()" name="">
       <p>{{ans}}</p>

        <!-- <div style="margin: 30px auto; width: 45px; height: 45px; border: 3px solid gray; border-radius: 30px; text-align: center; line-height: 42px; vertical-align: middle; color: blue;">
            {{num}}
        </div> -->
    </div>
 
</body>
<script src="constroller/myfilter.js"></script>
<script type="text/javascript">
// console.log(angular);
/*
    1.定义第一个模块,定义2个参数,1.模块名,2.数组(存储其他需要依赖的模块名字,当前模块需要依赖别的模块的话)
    2. ng-app="moduleOne"是主模块的作用域,跟angular.module(`moduleOne`,[])
    3. ng-controller="indexC" 是主模块下分模块的作用域,跟angular.module(`moduleOne`,[])
*/


let app = angular.module(`indexApp`, []);
//indexCtrl的域
let func = ($scope, $http, $rootScope,$sce,$filter,$interval,tool) => {
    $scope.html=`ababoiosdissaammddshn`;
    $scope.htmlSce=$sce.trustAsHtml($scope.html);
    $scope.makered = function(){
       let html = $filter(`myfilter`)($scope.html,$scope.search);
       $scope.htmlSce=$sce.trustAsHtml(html);
    };
    $rootScope.name = "根作用域";
    $scope.num = 10;

    console.log();
    let timer = $interval(()=>{
        $scope.num--;
        if($scope.num<=0){
            $interval.cancel(timer);
        }
    },1000);
    //跨域请求图灵机器人数据
    $scope.submit = ()=>{
        $http.jsonp(`http://1.wscatwscats.applinzi.com/turing.php`,{
            params:{
                callback:`JSON_CALLBACK`,
                que:$scope.ask
            }
        }).then(function(res){
            // console.log(res.data.text);
            $rootScope.ans = res.data.text;
        });
    }
    console.log(tool.add($scope.num,2));
};

//自定义指令
let first = () => {
    let directive = {
        restrict: "EAC",
        template: `switchName:{{switchName}}`
    };
    return directive;
}


//自定义服务
let tool = ()=>{
    return {
        add:(a,b)=>{
            return a+b;
        }
    }
}
app.controller(`indexCtrl`, [`$scope`, `$http`, `$rootScope`,`$sce`,`$filter`,`$interval`,`tool`,func]);
app.directive(`firstDirective`, first);
app.filter(`myfilter`,[`$http`,`$rootScope`,myfilter]);
app.service(`tool`,tool)
</script>

</html>
